# Payment System


### 1. Checkout 기능 구현
- 동일한 요청 파라미터로 N번 요청을 보내도 1번만 수행되어야 한다면? -> 멱등성 보장
  - 따닥 이슈, 네트워크 이슈로 동일한 주문에 대해 N번 결제를 요청했을 때 N번의 결제가 이루어지면 안됨.
  - 이런 일이 생기지 않도록 하기 위해 결제 API는 [멱등성](https://docs.tosspayments.com/blog/what-is-idempotency)을 보장할 수 있어야 한다.
  - 멱등성을 보장하기 위해 멱등성 Key가 필요한데 이번 구현에서는 Checkout 시점에 멱등성 Key를 만들고 orderId로 저장한다.
  - 결국, 동일한 주문을 식별할 수 있는 Key값을 결제 멱등성 Key로 사용한다.
  - 그런데 `동일한 주문`을 어떻게 볼 것인가를 먼저 고민해봐야 할 것 같다.
  - 현재 tossPayment 결제 페이지로 들어가는 시점에 orderId를 만든다.
  - 하지만 실제 이커머스 서비스에서는 주문/결제 페이지에 진입하는 시점에 `동일한 주문을 식별하는 ID` = `멱등성 Key`를 만든다.